; Listing generated by Microsoft (R) Optimizing Compiler Version 19.27.29111.0 

	TITLE	C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\ConnectBonus.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	?Query12@@3PADA					; Query12
PUBLIC	?TopOnline__LevelUpPoints@@3HA			; TopOnline__LevelUpPoints
_BSS	SEGMENT
?Query12@@3PADA DB 064H DUP (?)				; Query12
?TopOnline__LevelUpPoints@@3HA DD 01H DUP (?)		; TopOnline__LevelUpPoints
_BSS	ENDS
PUBLIC	?__empty_global_delete@@YAXPAX@Z		; __empty_global_delete
PUBLIC	?__empty_global_delete@@YAXPAXI@Z		; __empty_global_delete
PUBLIC	?AddTimeBonus@@YAXH@Z				; AddTimeBonus
PUBLIC	?YDTeamTopOnline@@YAXXZ				; YDTeamTopOnline
PUBLIC	??_C@_0BK@FGPPNPPM@?4?4?1?1data?1?1OnlineBonus?4ini@ ; `string'
PUBLIC	??_C@_0BM@IKFLDKNM@Mensaje?5de?5Cantidad?5de?5cash@ ; `string'
PUBLIC	??_C@_05JKBOBFBJ@Bonus@				; `string'
PUBLIC	??_C@_0EP@OJIAJPAO@UPDATE?5MuOnline?4dbo?4MEMB_INFO?5S@ ; `string'
PUBLIC	??_C@_0N@LBPLLNMN@UPDATE?5GOLDS@		; `string'
PUBLIC	??_C@_08JMCNDBPC@SQLBonus@			; `string'
PUBLIC	??_C@_0CA@CGMNINI@?$FLTimeBonus?$FN?5?5Ganaste?5?$CFd?5Cash?$CIs?$CJ@ ; `string'
EXTRN	__imp__GetPrivateProfileIntA@16:PROC
EXTRN	__imp__GetPrivateProfileStringA@24:PROC
EXTRN	?MsgOutput@@YAXHPADZZ:PROC			; MsgOutput
EXTRN	?ExecFormat@CDataBase@@QAA_NPBDZZ:PROC		; CDataBase::ExecFormat
EXTRN	?gObj@@3PAVOBJECTSTRUCT@@A:DWORD		; gObj
EXTRN	?Manager@@3VCManager@@A:BYTE			; Manager
EXTRN	?gConnectBonusTime@@3HA:DWORD			; gConnectBonusTime
EXTRN	?gConnectBonusCashPoints@@3HA:DWORD		; gConnectBonusCashPoints
;	COMDAT ??_C@_0CA@CGMNINI@?$FLTimeBonus?$FN?5?5Ganaste?5?$CFd?5Cash?$CIs?$CJ@
CONST	SEGMENT
??_C@_0CA@CGMNINI@?$FLTimeBonus?$FN?5?5Ganaste?5?$CFd?5Cash?$CIs?$CJ@ DB '['
	DB	'TimeBonus]  Ganaste %d Cash(s)', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_08JMCNDBPC@SQLBonus@
CONST	SEGMENT
??_C@_08JMCNDBPC@SQLBonus@ DB 'SQLBonus', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0N@LBPLLNMN@UPDATE?5GOLDS@
CONST	SEGMENT
??_C@_0N@LBPLLNMN@UPDATE?5GOLDS@ DB 'UPDATE GOLDS', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0EP@OJIAJPAO@UPDATE?5MuOnline?4dbo?4MEMB_INFO?5S@
CONST	SEGMENT
??_C@_0EP@OJIAJPAO@UPDATE?5MuOnline?4dbo?4MEMB_INFO?5S@ DB 'UPDATE MuOnli'
	DB	'ne.dbo.MEMB_INFO SET Credits = Credits + 5 Where memb___id = '
	DB	'''%s''', 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_05JKBOBFBJ@Bonus@
CONST	SEGMENT
??_C@_05JKBOBFBJ@Bonus@ DB 'Bonus', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0BM@IKFLDKNM@Mensaje?5de?5Cantidad?5de?5cash@
CONST	SEGMENT
??_C@_0BM@IKFLDKNM@Mensaje?5de?5Cantidad?5de?5cash@ DB 'Mensaje de Cantid'
	DB	'ad de cash', 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0BK@FGPPNPPM@?4?4?1?1data?1?1OnlineBonus?4ini@
CONST	SEGMENT
??_C@_0BK@FGPPNPPM@?4?4?1?1data?1?1OnlineBonus?4ini@ DB '..//data//Online'
	DB	'Bonus.ini', 00H				; `string'
CONST	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\ConnectBonus.cpp
;	COMDAT ?YDTeamTopOnline@@YAXXZ
_TEXT	SEGMENT
?YDTeamTopOnline@@YAXXZ PROC				; YDTeamTopOnline, COMDAT

; 8    : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 9    : 	TopOnline__LevelUpPoints = GetPrivateProfileIntA("Bonus", "Mensaje de Cantidad de cash", 5, "..//data//OnlineBonus.ini"); // si pero ponele tambien el mismo numero de la querry

  00009	68 00 00 00 00	 push	 OFFSET ??_C@_0BK@FGPPNPPM@?4?4?1?1data?1?1OnlineBonus?4ini@
  0000e	6a 05		 push	 5
  00010	68 00 00 00 00	 push	 OFFSET ??_C@_0BM@IKFLDKNM@Mensaje?5de?5Cantidad?5de?5cash@
  00015	68 00 00 00 00	 push	 OFFSET ??_C@_05JKBOBFBJ@Bonus@
  0001a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetPrivateProfileIntA@16
  00020	a3 00 00 00 00	 mov	 DWORD PTR ?TopOnline__LevelUpPoints@@3HA, eax ; TopOnline__LevelUpPoints

; 10   : 	GetPrivateProfileString("SQLBonus","UPDATE GOLDS","UPDATE MuOnline.dbo.MEMB_INFO SET Credits = Credits + 5 Where memb___id = '%s'",Query12,100,"..//data//OnlineBonus.ini");

  00025	68 00 00 00 00	 push	 OFFSET ??_C@_0BK@FGPPNPPM@?4?4?1?1data?1?1OnlineBonus?4ini@
  0002a	6a 64		 push	 100			; 00000064H
  0002c	68 00 00 00 00	 push	 OFFSET ?Query12@@3PADA	; Query12
  00031	68 00 00 00 00	 push	 OFFSET ??_C@_0EP@OJIAJPAO@UPDATE?5MuOnline?4dbo?4MEMB_INFO?5S@
  00036	68 00 00 00 00	 push	 OFFSET ??_C@_0N@LBPLLNMN@UPDATE?5GOLDS@
  0003b	68 00 00 00 00	 push	 OFFSET ??_C@_08JMCNDBPC@SQLBonus@
  00040	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetPrivateProfileStringA@24

; 11   : }

  00046	5f		 pop	 edi
  00047	5e		 pop	 esi
  00048	5b		 pop	 ebx
  00049	8b e5		 mov	 esp, ebp
  0004b	5d		 pop	 ebp
  0004c	c3		 ret	 0
?YDTeamTopOnline@@YAXXZ ENDP				; YDTeamTopOnline
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\ConnectBonus.cpp
;	COMDAT ?AddTimeBonus@@YAXH@Z
_TEXT	SEGMENT
_UserIndex$ = 8						; size = 4
?AddTimeBonus@@YAXH@Z PROC				; AddTimeBonus, COMDAT

; 13   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 14   : 	// ----
; 15   : 	if( gObj[UserIndex].m_ConnectBonusTime != gConnectBonusTime)

  00009	69 45 08 a0 1b
	00 00		 imul	 eax, DWORD PTR _UserIndex$[ebp], 7072
  00010	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAVOBJECTSTRUCT@@A ; gObj
  00016	8b 94 01 a4 1a
	00 00		 mov	 edx, DWORD PTR [ecx+eax+6820]
  0001d	3b 15 00 00 00
	00		 cmp	 edx, DWORD PTR ?gConnectBonusTime@@3HA ; gConnectBonusTime
  00023	74 05		 je	 SHORT $LN2@AddTimeBon

; 16   : 	{
; 17   : 		return;

  00025	e9 b9 00 00 00	 jmp	 $LN1@AddTimeBon
$LN2@AddTimeBon:

; 18   : 	}
; 19   : 	// ----
; 20   : 	gObj[UserIndex].m_ConnectBonusTime = 0;

  0002a	69 45 08 a0 1b
	00 00		 imul	 eax, DWORD PTR _UserIndex$[ebp], 7072
  00031	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAVOBJECTSTRUCT@@A ; gObj
  00037	c7 84 01 a4 1a
	00 00 00 00 00
	00		 mov	 DWORD PTR [ecx+eax+6820], 0

; 21   : 
; 22   : 	if ((gObj[UserIndex].OffExp == 1) || (gObj[UserIndex].Offtrade == 1)|| (gObj[UserIndex].OffAfk == 1))

  00042	69 45 08 a0 1b
	00 00		 imul	 eax, DWORD PTR _UserIndex$[ebp], 7072
  00049	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAVOBJECTSTRUCT@@A ; gObj
  0004f	0f b6 94 01 8c
	1a 00 00	 movzx	 edx, BYTE PTR [ecx+eax+6796]
  00057	83 fa 01	 cmp	 edx, 1
  0005a	74 34		 je	 SHORT $LN4@AddTimeBon
  0005c	69 45 08 a0 1b
	00 00		 imul	 eax, DWORD PTR _UserIndex$[ebp], 7072
  00063	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAVOBJECTSTRUCT@@A ; gObj
  00069	0f b6 94 01 86
	1a 00 00	 movzx	 edx, BYTE PTR [ecx+eax+6790]
  00071	83 fa 01	 cmp	 edx, 1
  00074	74 1a		 je	 SHORT $LN4@AddTimeBon
  00076	69 45 08 a0 1b
	00 00		 imul	 eax, DWORD PTR _UserIndex$[ebp], 7072
  0007d	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAVOBJECTSTRUCT@@A ; gObj
  00083	0f b6 94 01 85
	1a 00 00	 movzx	 edx, BYTE PTR [ecx+eax+6789]
  0008b	83 fa 01	 cmp	 edx, 1
  0008e	75 02		 jne	 SHORT $LN3@AddTimeBon
$LN4@AddTimeBon:

; 23   : 	{
; 24   : 		return;

  00090	eb 51		 jmp	 SHORT $LN1@AddTimeBon
$LN3@AddTimeBon:

; 25   : 	}
; 26   : 
; 27   : 	if (gConnectBonusCashPoints > 0)

  00092	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?gConnectBonusCashPoints@@3HA, 0 ; gConnectBonusCashPoints
  00099	7e 48		 jle	 SHORT $LN1@AddTimeBon

; 28   : 	{
; 29   : 		Manager.ExecFormat(Query12,gObj[UserIndex].AccountID);

  0009b	69 45 08 a0 1b
	00 00		 imul	 eax, DWORD PTR _UserIndex$[ebp], 7072
  000a2	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAVOBJECTSTRUCT@@A ; gObj
  000a8	8d 54 01 68	 lea	 edx, DWORD PTR [ecx+eax+104]
  000ac	52		 push	 edx
  000ad	68 00 00 00 00	 push	 OFFSET ?Query12@@3PADA	; Query12
  000b2	68 00 00 00 00	 push	 OFFSET ?Manager@@3VCManager@@A ; Manager
  000b7	e8 00 00 00 00	 call	 ?ExecFormat@CDataBase@@QAA_NPBDZZ ; CDataBase::ExecFormat
  000bc	83 c4 0c	 add	 esp, 12			; 0000000cH

; 30   : 		MsgOutput(gObj[UserIndex].m_Index, "[TimeBonus]  Ganaste %d Cash(s)", TopOnline__LevelUpPoints);

  000bf	a1 00 00 00 00	 mov	 eax, DWORD PTR ?TopOnline__LevelUpPoints@@3HA ; TopOnline__LevelUpPoints
  000c4	50		 push	 eax
  000c5	68 00 00 00 00	 push	 OFFSET ??_C@_0CA@CGMNINI@?$FLTimeBonus?$FN?5?5Ganaste?5?$CFd?5Cash?$CIs?$CJ@
  000ca	69 4d 08 a0 1b
	00 00		 imul	 ecx, DWORD PTR _UserIndex$[ebp], 7072
  000d1	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?gObj@@3PAVOBJECTSTRUCT@@A ; gObj
  000d7	8b 04 0a	 mov	 eax, DWORD PTR [edx+ecx]
  000da	50		 push	 eax
  000db	e8 00 00 00 00	 call	 ?MsgOutput@@YAXHPADZZ	; MsgOutput
  000e0	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN1@AddTimeBon:

; 31   : 		//LogAdd("[TimeBonus] Ganaste %d Cash(s) por tu Hora", TopOnline__LevelUpPoints);
; 32   : 
; 33   : 	}
; 34   : }

  000e3	5f		 pop	 edi
  000e4	5e		 pop	 esi
  000e5	5b		 pop	 ebx
  000e6	8b e5		 mov	 esp, ebp
  000e8	5d		 pop	 ebp
  000e9	c3		 ret	 0
?AddTimeBonus@@YAXH@Z ENDP				; AddTimeBonus
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\ConnectBonus.cpp
;	COMDAT ?__empty_global_delete@@YAXPAXI@Z
_TEXT	SEGMENT
___formal$ = 8						; size = 4
___formal$ = 12						; size = 4
?__empty_global_delete@@YAXPAXI@Z PROC			; __empty_global_delete, COMDAT

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	5f		 pop	 edi
  0000a	5e		 pop	 esi
  0000b	5b		 pop	 ebx
  0000c	8b e5		 mov	 esp, ebp
  0000e	5d		 pop	 ebp
  0000f	c3		 ret	 0
?__empty_global_delete@@YAXPAXI@Z ENDP			; __empty_global_delete
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\ConnectBonus.cpp
;	COMDAT ?__empty_global_delete@@YAXPAX@Z
_TEXT	SEGMENT
___formal$ = 8						; size = 4
?__empty_global_delete@@YAXPAX@Z PROC			; __empty_global_delete, COMDAT

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	5f		 pop	 edi
  0000a	5e		 pop	 esi
  0000b	5b		 pop	 ebx
  0000c	8b e5		 mov	 esp, ebp
  0000e	5d		 pop	 ebp
  0000f	c3		 ret	 0
?__empty_global_delete@@YAXPAX@Z ENDP			; __empty_global_delete
_TEXT	ENDS
END

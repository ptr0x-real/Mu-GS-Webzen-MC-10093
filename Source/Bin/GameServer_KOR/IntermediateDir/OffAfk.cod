; Listing generated by Microsoft (R) Optimizing Compiler Version 19.27.29111.0 

	TITLE	C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\OffAfk.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	?OFFSystem@@3VCOFFSystem@@A			; OFFSystem
_BSS	SEGMENT
?OFFSystem@@3VCOFFSystem@@A DB 01H DUP (?)		; OFFSystem
_BSS	ENDS
PUBLIC	?__empty_global_delete@@YAXPAX@Z		; __empty_global_delete
PUBLIC	?__empty_global_delete@@YAXPAXI@Z		; __empty_global_delete
PUBLIC	?CreateOfflineSystem@COFFSystem@@QAEXH@Z	; COFFSystem::CreateOfflineSystem
PUBLIC	?Closeoffafk@COFFSystem@@QAEXPAD@Z		; COFFSystem::Closeoffafk
PUBLIC	?Updateoffafk@COFFSystem@@QAE_NHE@Z		; COFFSystem::Updateoffafk
EXTRN	_strcmp:PROC
EXTRN	__imp__GetTickCount@0:PROC
EXTRN	?CloseClientEx@@YAXH@Z:PROC			; CloseClientEx
EXTRN	?gObjDel@@YAFH@Z:PROC				; gObjDel
EXTRN	?GJPUserClose2@@YAXPAD@Z:PROC			; GJPUserClose2
EXTRN	?gObj@@3PAVOBJECTSTRUCT@@A:DWORD		; gObj
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\OffAfk.cpp
;	COMDAT ?Updateoffafk@COFFSystem@@QAE_NHE@Z
_TEXT	SEGMENT
_lpUser$ = -8						; size = 4
_this$ = -4						; size = 4
_UserIndex$ = 8						; size = 4
_Type$ = 12						; size = 1
?Updateoffafk@COFFSystem@@QAE_NHE@Z PROC		; COFFSystem::Updateoffafk, COMDAT
; _this$ = ecx

; 49   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 48	 sub	 esp, 72			; 00000048H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 50   : 	LPOBJECTSTRUCT lpUser = &gObj[UserIndex];

  0000c	69 45 08 a0 1b
	00 00		 imul	 eax, DWORD PTR _UserIndex$[ebp], 7072
  00013	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAVOBJECTSTRUCT@@A ; gObj
  00019	89 45 f8	 mov	 DWORD PTR _lpUser$[ebp], eax

; 51   : 	// ----
; 52   : 	if (!lpUser->OffAfk)

  0001c	8b 45 f8	 mov	 eax, DWORD PTR _lpUser$[ebp]
  0001f	0f b6 88 85 1a
	00 00		 movzx	 ecx, BYTE PTR [eax+6789]
  00026	85 c9		 test	 ecx, ecx
  00028	75 04		 jne	 SHORT $LN2@Updateoffa

; 53   : 	{
; 54   : 		return false;

  0002a	32 c0		 xor	 al, al
  0002c	eb 2d		 jmp	 SHORT $LN1@Updateoffa
$LN2@Updateoffa:

; 55   : 	}
; 56   : 	// ----
; 57   : 	if (Type == 0)

  0002e	0f b6 45 0c	 movzx	 eax, BYTE PTR _Type$[ebp]
  00032	85 c0		 test	 eax, eax
  00034	75 0e		 jne	 SHORT $LN3@Updateoffa

; 58   : 	{
; 59   : 		lpUser->CheckTick = GetTickCount();

  00036	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetTickCount@0
  0003c	8b 4d f8	 mov	 ecx, DWORD PTR _lpUser$[ebp]
  0003f	89 41 3c	 mov	 DWORD PTR [ecx+60], eax

; 60   : 	}

  00042	eb 15		 jmp	 SHORT $LN4@Updateoffa
$LN3@Updateoffa:

; 61   : 	else if (Type == 1)

  00044	0f b6 45 0c	 movzx	 eax, BYTE PTR _Type$[ebp]
  00048	83 f8 01	 cmp	 eax, 1
  0004b	75 0c		 jne	 SHORT $LN4@Updateoffa

; 62   : 	{
; 63   : 		lpUser->ConnectCheckTime = GetTickCount();

  0004d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetTickCount@0
  00053	8b 4d f8	 mov	 ecx, DWORD PTR _lpUser$[ebp]
  00056	89 41 38	 mov	 DWORD PTR [ecx+56], eax
$LN4@Updateoffa:

; 64   : 	}
; 65   : 	// ----
; 66   : 	return true;

  00059	b0 01		 mov	 al, 1
$LN1@Updateoffa:

; 67   : }

  0005b	5f		 pop	 edi
  0005c	5e		 pop	 esi
  0005d	5b		 pop	 ebx
  0005e	8b e5		 mov	 esp, ebp
  00060	5d		 pop	 ebp
  00061	c2 08 00	 ret	 8
?Updateoffafk@COFFSystem@@QAE_NHE@Z ENDP		; COFFSystem::Updateoffafk
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\OffAfk.cpp
;	COMDAT ?Closeoffafk@COFFSystem@@QAEXPAD@Z
_TEXT	SEGMENT
_lpUser$1 = -12						; size = 4
_i$2 = -8						; size = 4
_this$ = -4						; size = 4
_AccountID$ = 8						; size = 4
?Closeoffafk@COFFSystem@@QAEXPAD@Z PROC			; COFFSystem::Closeoffafk, COMDAT
; _this$ = ecx

; 31   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 4c	 sub	 esp, 76			; 0000004cH
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 32   : 	for (int i = OBJ_STARTUSERINDEX; i < MAX_OBJECT; i++)

  0000c	c7 45 f8 00 19
	00 00		 mov	 DWORD PTR _i$2[ebp], 6400 ; 00001900H
  00013	eb 09		 jmp	 SHORT $LN4@Closeoffaf
$LN2@Closeoffaf:
  00015	8b 45 f8	 mov	 eax, DWORD PTR _i$2[ebp]
  00018	83 c0 01	 add	 eax, 1
  0001b	89 45 f8	 mov	 DWORD PTR _i$2[ebp], eax
$LN4@Closeoffaf:
  0001e	81 7d f8 e8 1c
	00 00		 cmp	 DWORD PTR _i$2[ebp], 7400 ; 00001ce8H
  00025	7d 76		 jge	 SHORT $LN1@Closeoffaf

; 33   : 	{
; 34   : 		LPOBJECTSTRUCT lpUser = &gObj[i];

  00027	69 45 f8 a0 1b
	00 00		 imul	 eax, DWORD PTR _i$2[ebp], 7072
  0002e	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAVOBJECTSTRUCT@@A ; gObj
  00034	89 45 f4	 mov	 DWORD PTR _lpUser$1[ebp], eax

; 35   : 		// ----
; 36   : 		if (lpUser->Connected != PLAYER_PLAYING || !lpUser->OffAfk || strcmp(AccountID, lpUser->AccountID))

  00037	8b 45 f4	 mov	 eax, DWORD PTR _lpUser$1[ebp]
  0003a	83 78 04 03	 cmp	 DWORD PTR [eax+4], 3
  0003e	75 25		 jne	 SHORT $LN6@Closeoffaf
  00040	8b 45 f4	 mov	 eax, DWORD PTR _lpUser$1[ebp]
  00043	0f b6 88 85 1a
	00 00		 movzx	 ecx, BYTE PTR [eax+6789]
  0004a	85 c9		 test	 ecx, ecx
  0004c	74 17		 je	 SHORT $LN6@Closeoffaf
  0004e	8b 45 f4	 mov	 eax, DWORD PTR _lpUser$1[ebp]
  00051	83 c0 68	 add	 eax, 104		; 00000068H
  00054	50		 push	 eax
  00055	8b 4d 08	 mov	 ecx, DWORD PTR _AccountID$[ebp]
  00058	51		 push	 ecx
  00059	e8 00 00 00 00	 call	 _strcmp
  0005e	83 c4 08	 add	 esp, 8
  00061	85 c0		 test	 eax, eax
  00063	74 02		 je	 SHORT $LN5@Closeoffaf
$LN6@Closeoffaf:

; 37   : 		{
; 38   : 			continue;

  00065	eb ae		 jmp	 SHORT $LN2@Closeoffaf
$LN5@Closeoffaf:

; 39   : 		}
; 40   : 		// ----
; 41   : 		CloseClientEx(i);

  00067	8b 45 f8	 mov	 eax, DWORD PTR _i$2[ebp]
  0006a	50		 push	 eax
  0006b	e8 00 00 00 00	 call	 ?CloseClientEx@@YAXH@Z	; CloseClientEx
  00070	83 c4 04	 add	 esp, 4

; 42   : 		GJPUserClose2(lpUser->AccountID);

  00073	8b 45 f4	 mov	 eax, DWORD PTR _lpUser$1[ebp]
  00076	83 c0 68	 add	 eax, 104		; 00000068H
  00079	50		 push	 eax
  0007a	e8 00 00 00 00	 call	 ?GJPUserClose2@@YAXPAD@Z ; GJPUserClose2
  0007f	83 c4 04	 add	 esp, 4

; 43   : 		gObjDel(i);

  00082	8b 45 f8	 mov	 eax, DWORD PTR _i$2[ebp]
  00085	50		 push	 eax
  00086	e8 00 00 00 00	 call	 ?gObjDel@@YAFH@Z	; gObjDel
  0008b	83 c4 04	 add	 esp, 4

; 44   : 		lpUser->OffAfk = false;

  0008e	8b 45 f4	 mov	 eax, DWORD PTR _lpUser$1[ebp]
  00091	c6 80 85 1a 00
	00 00		 mov	 BYTE PTR [eax+6789], 0

; 45   : 	}

  00098	e9 78 ff ff ff	 jmp	 $LN2@Closeoffaf
$LN1@Closeoffaf:

; 46   : }

  0009d	5f		 pop	 edi
  0009e	5e		 pop	 esi
  0009f	5b		 pop	 ebx
  000a0	8b e5		 mov	 esp, ebp
  000a2	5d		 pop	 ebp
  000a3	c2 04 00	 ret	 4
?Closeoffafk@COFFSystem@@QAEXPAD@Z ENDP			; COFFSystem::Closeoffafk
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\OffAfk.cpp
;	COMDAT ?CreateOfflineSystem@COFFSystem@@QAEXH@Z
_TEXT	SEGMENT
_lpObj$ = -8						; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
?CreateOfflineSystem@COFFSystem@@QAEXH@Z PROC		; COFFSystem::CreateOfflineSystem, COMDAT
; _this$ = ecx

; 14   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 48	 sub	 esp, 72			; 00000048H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 15   : 
; 16   : 	LPOBJECTSTRUCT lpObj = &gObj[aIndex];

  0000c	69 45 08 a0 1b
	00 00		 imul	 eax, DWORD PTR _aIndex$[ebp], 7072
  00013	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAVOBJECTSTRUCT@@A ; gObj
  00019	89 45 f8	 mov	 DWORD PTR _lpObj$[ebp], eax

; 17   : 	/*
; 18   : 	if(gObj[aIndex].MapNumber != 0)
; 19   : 	{
; 20   : 		MsgOutput(aIndex,"[OFFSystem][%s]Usted Necesita estar en Lorencia",gObj->Name);
; 21   : 		return;
; 22   : 	}
; 23   : 	*/
; 24   : 	lpObj->OffAfk = true;

  0001c	8b 45 f8	 mov	 eax, DWORD PTR _lpObj$[ebp]
  0001f	c6 80 85 1a 00
	00 01		 mov	 BYTE PTR [eax+6789], 1

; 25   : 	//CloseClient(aIndex);
; 26   : 	CloseClientEx(aIndex);

  00026	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  00029	50		 push	 eax
  0002a	e8 00 00 00 00	 call	 ?CloseClientEx@@YAXH@Z	; CloseClientEx
  0002f	83 c4 04	 add	 esp, 4

; 27   : 	return;
; 28   : }

  00032	5f		 pop	 edi
  00033	5e		 pop	 esi
  00034	5b		 pop	 ebx
  00035	8b e5		 mov	 esp, ebp
  00037	5d		 pop	 ebp
  00038	c2 04 00	 ret	 4
?CreateOfflineSystem@COFFSystem@@QAEXH@Z ENDP		; COFFSystem::CreateOfflineSystem
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\OffAfk.cpp
;	COMDAT ?__empty_global_delete@@YAXPAXI@Z
_TEXT	SEGMENT
___formal$ = 8						; size = 4
___formal$ = 12						; size = 4
?__empty_global_delete@@YAXPAXI@Z PROC			; __empty_global_delete, COMDAT

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	5f		 pop	 edi
  0000a	5e		 pop	 esi
  0000b	5b		 pop	 ebx
  0000c	8b e5		 mov	 esp, ebp
  0000e	5d		 pop	 ebp
  0000f	c3		 ret	 0
?__empty_global_delete@@YAXPAXI@Z ENDP			; __empty_global_delete
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\OffAfk.cpp
;	COMDAT ?__empty_global_delete@@YAXPAX@Z
_TEXT	SEGMENT
___formal$ = 8						; size = 4
?__empty_global_delete@@YAXPAX@Z PROC			; __empty_global_delete, COMDAT

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	5f		 pop	 edi
  0000a	5e		 pop	 esi
  0000b	5b		 pop	 ebx
  0000c	8b e5		 mov	 esp, ebp
  0000e	5d		 pop	 ebp
  0000f	c3		 ret	 0
?__empty_global_delete@@YAXPAX@Z ENDP			; __empty_global_delete
_TEXT	ENDS
END

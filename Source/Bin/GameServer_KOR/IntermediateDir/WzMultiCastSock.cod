; Listing generated by Microsoft (R) Optimizing Compiler Version 19.27.29111.0 

	TITLE	C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\WzMultiCastSock.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	?__empty_global_delete@@YAXPAX@Z		; __empty_global_delete
PUBLIC	?__empty_global_delete@@YAXPAXI@Z		; __empty_global_delete
PUBLIC	??0CWzMultiCastSock@@QAE@XZ			; CWzMultiCastSock::CWzMultiCastSock
PUBLIC	??1CWzMultiCastSock@@QAE@XZ			; CWzMultiCastSock::~CWzMultiCastSock
PUBLIC	?DoEnumIpAddress@CWzMultiCastSock@@QAEHXZ	; CWzMultiCastSock::DoEnumIpAddress
PUBLIC	?GetEnummedIpAddress@CWzMultiCastSock@@QAEHHPAD@Z ; CWzMultiCastSock::GetEnummedIpAddress
PUBLIC	?StartMultiCast@CWzMultiCastSock@@QAEHPAD@Z	; CWzMultiCastSock::StartMultiCast
PUBLIC	?ReStartMultiCast@CWzMultiCastSock@@QAEHXZ	; CWzMultiCastSock::ReStartMultiCast
PUBLIC	?EndMultiCast@CWzMultiCastSock@@QAEXXZ		; CWzMultiCastSock::EndMultiCast
PUBLIC	?SendData@CWzMultiCastSock@@QAEHPADH@Z		; CWzMultiCastSock::SendData
PUBLIC	?RecvThreadProc@CWzMultiCastSock@@SGIPAX@Z	; CWzMultiCastSock::RecvThreadProc
PUBLIC	?SaveLastError@CWzMultiCastSock@@IAEXH@Z	; CWzMultiCastSock::SaveLastError
PUBLIC	?SavePrivateErrorMessage@CWzMultiCastSock@@IAEXPAD@Z ; CWzMultiCastSock::SavePrivateErrorMessage
PUBLIC	??_C@_0BA@CLENKLPL@227?4100?4100?4100@		; `string'
PUBLIC	??_C@_0CG@POBBELLP@RecvThreadProc?$CI?$CJ?5ERROR?5?3?5iRecvL@ ; `string'
EXTRN	_memcpy:PROC
EXTRN	_memset:PROC
EXTRN	_strcpy:PROC
EXTRN	__imp__CloseHandle@4:PROC
EXTRN	__imp__TerminateThread@8:PROC
EXTRN	__imp__FormatMessageA@28:PROC
EXTRN	__imp__bind@12:PROC
EXTRN	__imp__closesocket@4:PROC
EXTRN	__imp__htonl@4:PROC
EXTRN	__imp__htons@4:PROC
EXTRN	__imp__inet_addr@4:PROC
EXTRN	__imp__inet_ntoa@4:PROC
EXTRN	__imp__recvfrom@24:PROC
EXTRN	__imp__sendto@24:PROC
EXTRN	__imp__setsockopt@20:PROC
EXTRN	__imp__shutdown@8:PROC
EXTRN	__imp__socket@12:PROC
EXTRN	__imp__gethostbyname@4:PROC
EXTRN	__imp__gethostname@8:PROC
EXTRN	__imp__WSAStartup@8:PROC
EXTRN	__imp__WSACleanup@0:PROC
EXTRN	__imp__WSAGetLastError@0:PROC
EXTRN	__beginthreadex:PROC
EXTRN	@__security_check_cookie@4:PROC
EXTRN	___security_cookie:DWORD
;	COMDAT ??_C@_0CG@POBBELLP@RecvThreadProc?$CI?$CJ?5ERROR?5?3?5iRecvL@
CONST	SEGMENT
??_C@_0CG@POBBELLP@RecvThreadProc?$CI?$CJ?5ERROR?5?3?5iRecvL@ DB 'RecvThr'
	DB	'eadProc() ERROR : iRecvLen < 0', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0BA@CLENKLPL@227?4100?4100?4100@
CONST	SEGMENT
??_C@_0BA@CLENKLPL@227?4100?4100?4100@ DB '227.100.100.100', 00H ; `string'
CONST	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\WzMultiCastSock.cpp
;	COMDAT ?SavePrivateErrorMessage@CWzMultiCastSock@@IAEXPAD@Z
_TEXT	SEGMENT
_this$ = -4						; size = 4
_lpszErrorMessage$ = 8					; size = 4
?SavePrivateErrorMessage@CWzMultiCastSock@@IAEXPAD@Z PROC ; CWzMultiCastSock::SavePrivateErrorMessage, COMDAT
; _this$ = ecx

; 236  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 237  : 	m_uLastErrorNum = 0;

  0000c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000f	c7 80 98 02 00
	00 00 00 00 00	 mov	 DWORD PTR [eax+664], 0

; 238  : 	strcpy (m_szLastErrorMessage, lpszErrorMessage);

  00019	8b 45 08	 mov	 eax, DWORD PTR _lpszErrorMessage$[ebp]
  0001c	50		 push	 eax
  0001d	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00020	81 c1 9c 02 00
	00		 add	 ecx, 668		; 0000029cH
  00026	51		 push	 ecx
  00027	e8 00 00 00 00	 call	 _strcpy
  0002c	83 c4 08	 add	 esp, 8

; 239  : 
; 240  : 	if (m_lpfnCALLBACK_ERRORNOTIFY)

  0002f	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00032	83 b8 ac 03 00
	00 00		 cmp	 DWORD PTR [eax+940], 0
  00039	74 25		 je	 SHORT $LN1@SavePrivat

; 241  : 		(* m_lpfnCALLBACK_ERRORNOTIFY) (this, m_uLastErrorNum, m_szLastErrorMessage);

  0003b	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0003e	05 9c 02 00 00	 add	 eax, 668		; 0000029cH
  00043	50		 push	 eax
  00044	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00047	8b 91 98 02 00
	00		 mov	 edx, DWORD PTR [ecx+664]
  0004d	52		 push	 edx
  0004e	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00051	50		 push	 eax
  00052	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00055	8b 91 ac 03 00
	00		 mov	 edx, DWORD PTR [ecx+940]
  0005b	ff d2		 call	 edx
  0005d	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN1@SavePrivat:

; 242  : }

  00060	5f		 pop	 edi
  00061	5e		 pop	 esi
  00062	5b		 pop	 ebx
  00063	8b e5		 mov	 esp, ebp
  00065	5d		 pop	 ebp
  00066	c2 04 00	 ret	 4
?SavePrivateErrorMessage@CWzMultiCastSock@@IAEXPAD@Z ENDP ; CWzMultiCastSock::SavePrivateErrorMessage
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\WzMultiCastSock.cpp
;	COMDAT ?SaveLastError@CWzMultiCastSock@@IAEXH@Z
_TEXT	SEGMENT
_this$ = -4						; size = 4
_iErrorNo$ = 8						; size = 4
?SaveLastError@CWzMultiCastSock@@IAEXH@Z PROC		; CWzMultiCastSock::SaveLastError, COMDAT
; _this$ = ecx

; 220  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 221  : 	if (!iErrorNo)

  0000c	83 7d 08 00	 cmp	 DWORD PTR _iErrorNo$[ebp], 0
  00010	75 11		 jne	 SHORT $LN2@SaveLastEr

; 222  : 		m_uLastErrorNum = WSAGetLastError();

  00012	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSAGetLastError@0
  00018	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0001b	89 81 98 02 00
	00		 mov	 DWORD PTR [ecx+664], eax
  00021	eb 0c		 jmp	 SHORT $LN3@SaveLastEr
$LN2@SaveLastEr:

; 223  : 	else
; 224  : 		m_uLastErrorNum = iErrorNo;

  00023	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00026	8b 4d 08	 mov	 ecx, DWORD PTR _iErrorNo$[ebp]
  00029	89 88 98 02 00
	00		 mov	 DWORD PTR [eax+664], ecx
$LN3@SaveLastEr:

; 225  : 
; 226  : 	memset (m_szLastErrorMessage, 0, sizeof(m_szLastErrorMessage));

  0002f	68 04 01 00 00	 push	 260			; 00000104H
  00034	6a 00		 push	 0
  00036	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00039	05 9c 02 00 00	 add	 eax, 668		; 0000029cH
  0003e	50		 push	 eax
  0003f	e8 00 00 00 00	 call	 _memset
  00044	83 c4 0c	 add	 esp, 12			; 0000000cH

; 227  : 
; 228  : 	FormatMessage (FORMAT_MESSAGE_FROM_SYSTEM, NULL, m_uLastErrorNum, 0, m_szLastErrorMessage, sizeof (m_szLastErrorMessage), NULL);

  00047	6a 00		 push	 0
  00049	68 04 01 00 00	 push	 260			; 00000104H
  0004e	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00051	05 9c 02 00 00	 add	 eax, 668		; 0000029cH
  00056	50		 push	 eax
  00057	6a 00		 push	 0
  00059	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0005c	8b 91 98 02 00
	00		 mov	 edx, DWORD PTR [ecx+664]
  00062	52		 push	 edx
  00063	6a 00		 push	 0
  00065	68 00 10 00 00	 push	 4096			; 00001000H
  0006a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__FormatMessageA@28

; 229  : 
; 230  : 	if (m_lpfnCALLBACK_ERRORNOTIFY)

  00070	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00073	83 b8 ac 03 00
	00 00		 cmp	 DWORD PTR [eax+940], 0
  0007a	74 25		 je	 SHORT $LN1@SaveLastEr

; 231  : 		(* m_lpfnCALLBACK_ERRORNOTIFY) (this, m_uLastErrorNum, m_szLastErrorMessage);

  0007c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0007f	05 9c 02 00 00	 add	 eax, 668		; 0000029cH
  00084	50		 push	 eax
  00085	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00088	8b 91 98 02 00
	00		 mov	 edx, DWORD PTR [ecx+664]
  0008e	52		 push	 edx
  0008f	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00092	50		 push	 eax
  00093	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00096	8b 91 ac 03 00
	00		 mov	 edx, DWORD PTR [ecx+940]
  0009c	ff d2		 call	 edx
  0009e	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN1@SaveLastEr:

; 232  : }

  000a1	5f		 pop	 edi
  000a2	5e		 pop	 esi
  000a3	5b		 pop	 ebx
  000a4	8b e5		 mov	 esp, ebp
  000a6	5d		 pop	 ebp
  000a7	c2 04 00	 ret	 4
?SaveLastError@CWzMultiCastSock@@IAEXH@Z ENDP		; CWzMultiCastSock::SaveLastError
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\WzMultiCastSock.cpp
;	COMDAT ?RecvThreadProc@CWzMultiCastSock@@SGIPAX@Z
_TEXT	SEGMENT
tv88 = -1260						; size = 4
_btSubCode$1 = -1062					; size = 1
_btHeadCode$2 = -1061					; size = 1
_iSize$3 = -1060					; size = 4
_iRecvLen$4 = -1056					; size = 4
_lpCMSock$ = -1052					; size = 4
_isockaddr_len$ = -1048					; size = 4
_sockaddr$ = -1044					; size = 16
_cBUFFER$ = -1028					; size = 1024
__$ArrayPad$ = -4					; size = 4
_lpParam$ = 8						; size = 4
?RecvThreadProc@CWzMultiCastSock@@SGIPAX@Z PROC		; CWzMultiCastSock::RecvThreadProc, COMDAT

; 246  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec ec 04 00
	00		 sub	 esp, 1260		; 000004ecH
  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000e	33 c5		 xor	 eax, ebp
  00010	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00013	53		 push	 ebx
  00014	56		 push	 esi
  00015	57		 push	 edi

; 247  : 	char cBUFFER [1024];
; 248  : 	SOCKADDR_IN sockaddr;
; 249  : 	int isockaddr_len = sizeof(sockaddr);

  00016	c7 85 e8 fb ff
	ff 10 00 00 00	 mov	 DWORD PTR _isockaddr_len$[ebp], 16 ; 00000010H

; 250  : 	
; 251  : 	CWzMultiCastSock * lpCMSock = (CWzMultiCastSock *) lpParam;

  00020	8b 45 08	 mov	 eax, DWORD PTR _lpParam$[ebp]
  00023	89 85 e4 fb ff
	ff		 mov	 DWORD PTR _lpCMSock$[ebp], eax
$LN2@RecvThread:

; 252  : 
; 253  : 	lpCMSock->m_skSocket;
; 254  : 
; 255  : 	while (1) {

  00029	b8 01 00 00 00	 mov	 eax, 1
  0002e	85 c0		 test	 eax, eax
  00030	0f 84 db 01 00
	00		 je	 $LN3@RecvThread

; 256  : 		int iRecvLen = recvfrom (lpCMSock->m_skSocket, cBUFFER, sizeof (cBUFFER), 0, (LPSOCKADDR) & sockaddr, & isockaddr_len);

  00036	8d 85 e8 fb ff
	ff		 lea	 eax, DWORD PTR _isockaddr_len$[ebp]
  0003c	50		 push	 eax
  0003d	8d 8d ec fb ff
	ff		 lea	 ecx, DWORD PTR _sockaddr$[ebp]
  00043	51		 push	 ecx
  00044	6a 00		 push	 0
  00046	68 00 04 00 00	 push	 1024			; 00000400H
  0004b	8d 95 fc fb ff
	ff		 lea	 edx, DWORD PTR _cBUFFER$[ebp]
  00051	52		 push	 edx
  00052	8b 85 e4 fb ff
	ff		 mov	 eax, DWORD PTR _lpCMSock$[ebp]
  00058	8b 08		 mov	 ecx, DWORD PTR [eax]
  0005a	51		 push	 ecx
  0005b	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__recvfrom@24
  00061	89 85 e0 fb ff
	ff		 mov	 DWORD PTR _iRecvLen$4[ebp], eax

; 257  : 
; 258  : 		if (iRecvLen ==	SOCKET_ERROR) {

  00067	83 bd e0 fb ff
	ff ff		 cmp	 DWORD PTR _iRecvLen$4[ebp], -1
  0006e	75 2f		 jne	 SHORT $LN6@RecvThread

; 259  : 			lpCMSock->SaveLastError();

  00070	6a 00		 push	 0
  00072	8b 8d e4 fb ff
	ff		 mov	 ecx, DWORD PTR _lpCMSock$[ebp]
  00078	e8 00 00 00 00	 call	 ?SaveLastError@CWzMultiCastSock@@IAEXH@Z ; CWzMultiCastSock::SaveLastError

; 260  : 			closesocket(lpCMSock->m_skSocket);

  0007d	8b 85 e4 fb ff
	ff		 mov	 eax, DWORD PTR _lpCMSock$[ebp]
  00083	8b 08		 mov	 ecx, DWORD PTR [eax]
  00085	51		 push	 ecx
  00086	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__closesocket@4

; 261  : 			lpCMSock->m_skSocket = INVALID_SOCKET;

  0008c	8b 85 e4 fb ff
	ff		 mov	 eax, DWORD PTR _lpCMSock$[ebp]
  00092	c7 00 ff ff ff
	ff		 mov	 DWORD PTR [eax], -1

; 262  : 			break;

  00098	e9 74 01 00 00	 jmp	 $LN3@RecvThread

; 263  : 		}

  0009d	eb 39		 jmp	 SHORT $LN7@RecvThread
$LN6@RecvThread:

; 264  : 		else if (iRecvLen < 0 ) {

  0009f	83 bd e0 fb ff
	ff 00		 cmp	 DWORD PTR _iRecvLen$4[ebp], 0
  000a6	7d 30		 jge	 SHORT $LN7@RecvThread

; 265  : 			lpCMSock->SavePrivateErrorMessage("RecvThreadProc() ERROR : iRecvLen < 0");

  000a8	68 00 00 00 00	 push	 OFFSET ??_C@_0CG@POBBELLP@RecvThreadProc?$CI?$CJ?5ERROR?5?3?5iRecvL@
  000ad	8b 8d e4 fb ff
	ff		 mov	 ecx, DWORD PTR _lpCMSock$[ebp]
  000b3	e8 00 00 00 00	 call	 ?SavePrivateErrorMessage@CWzMultiCastSock@@IAEXPAD@Z ; CWzMultiCastSock::SavePrivateErrorMessage

; 266  : 			closesocket(lpCMSock->m_skSocket);

  000b8	8b 85 e4 fb ff
	ff		 mov	 eax, DWORD PTR _lpCMSock$[ebp]
  000be	8b 08		 mov	 ecx, DWORD PTR [eax]
  000c0	51		 push	 ecx
  000c1	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__closesocket@4

; 267  : 			lpCMSock->m_skSocket = INVALID_SOCKET;

  000c7	8b 85 e4 fb ff
	ff		 mov	 eax, DWORD PTR _lpCMSock$[ebp]
  000cd	c7 00 ff ff ff
	ff		 mov	 DWORD PTR [eax], -1

; 268  : 			break;

  000d3	e9 39 01 00 00	 jmp	 $LN3@RecvThread
$LN7@RecvThread:

; 269  : 		}
; 270  : 
; 271  : 		// 실제로 받은 패킷을 파싱
; 272  : 		INT iSize = 0;

  000d8	c7 85 dc fb ff
	ff 00 00 00 00	 mov	 DWORD PTR _iSize$3[ebp], 0

; 273  : 		BYTE btHeadCode = 0, btSubCode = 0;				// sub code can be no use. (most of time it'll be a trash)

  000e2	c6 85 db fb ff
	ff 00		 mov	 BYTE PTR _btHeadCode$2[ebp], 0
  000e9	c6 85 da fb ff
	ff 00		 mov	 BYTE PTR _btSubCode$1[ebp], 0

; 274  : 
; 275  : 		switch ( (unsigned char) cBUFFER [0] ) {

  000f0	b8 01 00 00 00	 mov	 eax, 1
  000f5	6b c8 00	 imul	 ecx, eax, 0
  000f8	8a 94 0d fc fb
	ff ff		 mov	 dl, BYTE PTR _cBUFFER$[ebp+ecx]
  000ff	88 95 14 fb ff
	ff		 mov	 BYTE PTR tv88[ebp], dl
  00105	80 bd 14 fb ff
	ff c1		 cmp	 BYTE PTR tv88[ebp], 193	; 000000c1H
  0010c	74 0e		 je	 SHORT $LN9@RecvThread
  0010e	80 bd 14 fb ff
	ff c2		 cmp	 BYTE PTR tv88[ebp], 194	; 000000c2H
  00115	74 78		 je	 SHORT $LN11@RecvThread
  00117	e9 f0 00 00 00	 jmp	 $LN4@RecvThread
$LN9@RecvThread:

; 276  : 
; 277  : 		case 0xC1 :	// packet size is byte range ( 1 ~ 255 )
; 278  : 			iSize = ((LPPBMSG_HEAD)(cBUFFER))->size;

  0011c	0f b6 85 fd fb
	ff ff		 movzx	 eax, BYTE PTR _cBUFFER$[ebp+1]
  00123	89 85 dc fb ff
	ff		 mov	 DWORD PTR _iSize$3[ebp], eax

; 279  : 			btHeadCode = ((LPPBMSG_HEAD) (cBUFFER))->headcode;

  00129	8a 85 fe fb ff
	ff		 mov	 al, BYTE PTR _cBUFFER$[ebp+2]
  0012f	88 85 db fb ff
	ff		 mov	 BYTE PTR _btHeadCode$2[ebp], al

; 280  : 			btSubCode = ((LPPBMSG_HEAD2) (cBUFFER))->subcode;

  00135	8a 85 ff fb ff
	ff		 mov	 al, BYTE PTR _cBUFFER$[ebp+3]
  0013b	88 85 da fb ff
	ff		 mov	 BYTE PTR _btSubCode$1[ebp], al

; 281  : 			if (lpCMSock->m_lpfnCALLBACK_RECVNOTIFY)

  00141	8b 85 e4 fb ff
	ff		 mov	 eax, DWORD PTR _lpCMSock$[ebp]
  00147	83 b8 a8 03 00
	00 00		 cmp	 DWORD PTR [eax+936], 0
  0014e	74 3d		 je	 SHORT $LN10@RecvThread

; 282  : 				(* lpCMSock->m_lpfnCALLBACK_RECVNOTIFY) (lpCMSock, sockaddr.sin_addr.s_addr, btHeadCode, btSubCode, cBUFFER, iRecvLen);

  00150	8b 85 e0 fb ff
	ff		 mov	 eax, DWORD PTR _iRecvLen$4[ebp]
  00156	50		 push	 eax
  00157	8d 8d fc fb ff
	ff		 lea	 ecx, DWORD PTR _cBUFFER$[ebp]
  0015d	51		 push	 ecx
  0015e	0f b6 95 da fb
	ff ff		 movzx	 edx, BYTE PTR _btSubCode$1[ebp]
  00165	52		 push	 edx
  00166	0f b6 85 db fb
	ff ff		 movzx	 eax, BYTE PTR _btHeadCode$2[ebp]
  0016d	50		 push	 eax
  0016e	8b 8d f0 fb ff
	ff		 mov	 ecx, DWORD PTR _sockaddr$[ebp+4]
  00174	51		 push	 ecx
  00175	8b 95 e4 fb ff
	ff		 mov	 edx, DWORD PTR _lpCMSock$[ebp]
  0017b	52		 push	 edx
  0017c	8b 85 e4 fb ff
	ff		 mov	 eax, DWORD PTR _lpCMSock$[ebp]
  00182	8b 88 a8 03 00
	00		 mov	 ecx, DWORD PTR [eax+936]
  00188	ff d1		 call	 ecx
  0018a	83 c4 18	 add	 esp, 24			; 00000018H
$LN10@RecvThread:

; 283  : 			break;

  0018d	eb 7d		 jmp	 SHORT $LN4@RecvThread
$LN11@RecvThread:

; 284  : 
; 285  : 		case 0xC2 :	// packet size is word range ( 1 ~ 65535 )
; 286  : 			iSize = ((INT)  (((LPPWMSG_HEAD)(cBUFFER))->sizeH << 8)) + ((LPPWMSG_HEAD)(cBUFFER))->sizeL;

  0018f	0f b6 85 fd fb
	ff ff		 movzx	 eax, BYTE PTR _cBUFFER$[ebp+1]
  00196	c1 e0 08	 shl	 eax, 8
  00199	0f b6 8d fe fb
	ff ff		 movzx	 ecx, BYTE PTR _cBUFFER$[ebp+2]
  001a0	03 c1		 add	 eax, ecx
  001a2	89 85 dc fb ff
	ff		 mov	 DWORD PTR _iSize$3[ebp], eax

; 287  : 			btHeadCode = ((LPPWMSG_HEAD) (cBUFFER))->headcode;

  001a8	8a 85 ff fb ff
	ff		 mov	 al, BYTE PTR _cBUFFER$[ebp+3]
  001ae	88 85 db fb ff
	ff		 mov	 BYTE PTR _btHeadCode$2[ebp], al

; 288  : 			btSubCode = ((LPPWMSG_HEAD2) (cBUFFER))->subcode;

  001b4	8a 85 00 fc ff
	ff		 mov	 al, BYTE PTR _cBUFFER$[ebp+4]
  001ba	88 85 da fb ff
	ff		 mov	 BYTE PTR _btSubCode$1[ebp], al

; 289  : 			if (lpCMSock->m_lpfnCALLBACK_RECVNOTIFY)

  001c0	8b 85 e4 fb ff
	ff		 mov	 eax, DWORD PTR _lpCMSock$[ebp]
  001c6	83 b8 a8 03 00
	00 00		 cmp	 DWORD PTR [eax+936], 0
  001cd	74 3d		 je	 SHORT $LN4@RecvThread

; 290  : 				(* lpCMSock->m_lpfnCALLBACK_RECVNOTIFY) (lpCMSock, sockaddr.sin_addr.s_addr, btHeadCode, btSubCode, cBUFFER, iRecvLen);

  001cf	8b 85 e0 fb ff
	ff		 mov	 eax, DWORD PTR _iRecvLen$4[ebp]
  001d5	50		 push	 eax
  001d6	8d 8d fc fb ff
	ff		 lea	 ecx, DWORD PTR _cBUFFER$[ebp]
  001dc	51		 push	 ecx
  001dd	0f b6 95 da fb
	ff ff		 movzx	 edx, BYTE PTR _btSubCode$1[ebp]
  001e4	52		 push	 edx
  001e5	0f b6 85 db fb
	ff ff		 movzx	 eax, BYTE PTR _btHeadCode$2[ebp]
  001ec	50		 push	 eax
  001ed	8b 8d f0 fb ff
	ff		 mov	 ecx, DWORD PTR _sockaddr$[ebp+4]
  001f3	51		 push	 ecx
  001f4	8b 95 e4 fb ff
	ff		 mov	 edx, DWORD PTR _lpCMSock$[ebp]
  001fa	52		 push	 edx
  001fb	8b 85 e4 fb ff
	ff		 mov	 eax, DWORD PTR _lpCMSock$[ebp]
  00201	8b 88 a8 03 00
	00		 mov	 ecx, DWORD PTR [eax+936]
  00207	ff d1		 call	 ecx
  00209	83 c4 18	 add	 esp, 24			; 00000018H
$LN4@RecvThread:

; 291  : 			break;
; 292  : 
; 293  : 		default :	// must be error
; 294  : 			break;
; 295  : 		}
; 296  : 	}

  0020c	e9 18 fe ff ff	 jmp	 $LN2@RecvThread
$LN3@RecvThread:

; 297  : 	
; 298  : 	return 0;

  00211	33 c0		 xor	 eax, eax

; 299  : }

  00213	5f		 pop	 edi
  00214	5e		 pop	 esi
  00215	5b		 pop	 ebx
  00216	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00219	33 cd		 xor	 ecx, ebp
  0021b	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00220	8b e5		 mov	 esp, ebp
  00222	5d		 pop	 ebp
  00223	c2 04 00	 ret	 4
?RecvThreadProc@CWzMultiCastSock@@SGIPAX@Z ENDP		; CWzMultiCastSock::RecvThreadProc
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\WzMultiCastSock.cpp
;	COMDAT ?SendData@CWzMultiCastSock@@QAEHPADH@Z
_TEXT	SEGMENT
_iSENDBYTES$ = -28					; size = 4
_sockaddr$ = -24					; size = 16
_this$ = -8						; size = 4
__$ArrayPad$ = -4					; size = 4
_lpBUFFER$ = 8						; size = 4
_iBUFSIZE$ = 12						; size = 4
?SendData@CWzMultiCastSock@@QAEHPADH@Z PROC		; CWzMultiCastSock::SendData, COMDAT
; _this$ = ecx

; 191  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 5c	 sub	 esp, 92			; 0000005cH
  00006	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000b	33 c5		 xor	 eax, ebp
  0000d	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00010	53		 push	 ebx
  00011	56		 push	 esi
  00012	57		 push	 edi
  00013	89 4d f8	 mov	 DWORD PTR _this$[ebp], ecx

; 192  : 	if (!lpBUFFER)	

  00016	83 7d 08 00	 cmp	 DWORD PTR _lpBUFFER$[ebp], 0
  0001a	75 07		 jne	 SHORT $LN2@SendData

; 193  : 		return FALSE;

  0001c	33 c0		 xor	 eax, eax
  0001e	e9 9e 00 00 00	 jmp	 $LN1@SendData
$LN2@SendData:

; 194  : 
; 195  : 	SOCKADDR_IN sockaddr;
; 196  : 	sockaddr.sin_family			= AF_INET;

  00023	b8 02 00 00 00	 mov	 eax, 2
  00028	66 89 45 e8	 mov	 WORD PTR _sockaddr$[ebp], ax

; 197  : 	sockaddr.sin_addr.s_addr	= inet_addr (DEFAULT_MULTICAST_IP);

  0002c	68 00 00 00 00	 push	 OFFSET ??_C@_0BA@CLENKLPL@227?4100?4100?4100@
  00031	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__inet_addr@4
  00037	89 45 ec	 mov	 DWORD PTR _sockaddr$[ebp+4], eax

; 198  : 	sockaddr.sin_port			= htons (DEFAULT_MULTICAST_PORT);

  0003a	68 89 93 00 00	 push	 37769			; 00009389H
  0003f	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__htons@4
  00045	66 89 45 ea	 mov	 WORD PTR _sockaddr$[ebp+2], ax

; 199  : 
; 200  : 	int iSENDBYTES = sendto (m_skSocket, lpBUFFER, iBUFSIZE, 0, (LPSOCKADDR) & sockaddr, sizeof(sockaddr));

  00049	6a 10		 push	 16			; 00000010H
  0004b	8d 45 e8	 lea	 eax, DWORD PTR _sockaddr$[ebp]
  0004e	50		 push	 eax
  0004f	6a 00		 push	 0
  00051	8b 4d 0c	 mov	 ecx, DWORD PTR _iBUFSIZE$[ebp]
  00054	51		 push	 ecx
  00055	8b 55 08	 mov	 edx, DWORD PTR _lpBUFFER$[ebp]
  00058	52		 push	 edx
  00059	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0005c	8b 08		 mov	 ecx, DWORD PTR [eax]
  0005e	51		 push	 ecx
  0005f	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__sendto@24
  00065	89 45 e4	 mov	 DWORD PTR _iSENDBYTES$[ebp], eax

; 201  : 
; 202  : 	if (iSENDBYTES == SOCKET_ERROR) {

  00068	83 7d e4 ff	 cmp	 DWORD PTR _iSENDBYTES$[ebp], -1
  0006c	75 25		 jne	 SHORT $LN3@SendData

; 203  : 		SaveLastError();

  0006e	6a 00		 push	 0
  00070	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  00073	e8 00 00 00 00	 call	 ?SaveLastError@CWzMultiCastSock@@IAEXH@Z ; CWzMultiCastSock::SaveLastError

; 204  : 		closesocket(m_skSocket);

  00078	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0007b	8b 08		 mov	 ecx, DWORD PTR [eax]
  0007d	51		 push	 ecx
  0007e	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__closesocket@4

; 205  : 		m_skSocket = INVALID_SOCKET;

  00084	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00087	c7 00 ff ff ff
	ff		 mov	 DWORD PTR [eax], -1

; 206  : 		return FALSE;

  0008d	33 c0		 xor	 eax, eax
  0008f	eb 30		 jmp	 SHORT $LN1@SendData

; 207  : 	}

  00091	eb 29		 jmp	 SHORT $LN4@SendData
$LN3@SendData:

; 208  : 	else if (iSENDBYTES < -1) {

  00093	83 7d e4 ff	 cmp	 DWORD PTR _iSENDBYTES$[ebp], -1
  00097	7d 23		 jge	 SHORT $LN4@SendData

; 209  : 		SaveLastError();

  00099	6a 00		 push	 0
  0009b	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  0009e	e8 00 00 00 00	 call	 ?SaveLastError@CWzMultiCastSock@@IAEXH@Z ; CWzMultiCastSock::SaveLastError

; 210  : 		closesocket(m_skSocket);

  000a3	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  000a6	8b 08		 mov	 ecx, DWORD PTR [eax]
  000a8	51		 push	 ecx
  000a9	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__closesocket@4

; 211  : 		m_skSocket = INVALID_SOCKET;

  000af	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  000b2	c7 00 ff ff ff
	ff		 mov	 DWORD PTR [eax], -1

; 212  : 		return FALSE;

  000b8	33 c0		 xor	 eax, eax
  000ba	eb 05		 jmp	 SHORT $LN1@SendData
$LN4@SendData:

; 213  : 	}
; 214  : 
; 215  : 	return TRUE;

  000bc	b8 01 00 00 00	 mov	 eax, 1
$LN1@SendData:

; 216  : }

  000c1	5f		 pop	 edi
  000c2	5e		 pop	 esi
  000c3	5b		 pop	 ebx
  000c4	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  000c7	33 cd		 xor	 ecx, ebp
  000c9	e8 00 00 00 00	 call	 @__security_check_cookie@4
  000ce	8b e5		 mov	 esp, ebp
  000d0	5d		 pop	 ebp
  000d1	c2 08 00	 ret	 8
?SendData@CWzMultiCastSock@@QAEHPADH@Z ENDP		; CWzMultiCastSock::SendData
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\WzMultiCastSock.cpp
;	COMDAT ?EndMultiCast@CWzMultiCastSock@@QAEXXZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
?EndMultiCast@CWzMultiCastSock@@QAEXXZ PROC		; CWzMultiCastSock::EndMultiCast, COMDAT
; _this$ = ecx

; 175  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 176  : 	if (m_skSocket != INVALID_SOCKET) {

  0000c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000f	83 38 ff	 cmp	 DWORD PTR [eax], -1
  00012	74 15		 je	 SHORT $LN2@EndMultiCa

; 177  : 		// 이전에 소켓이 생성되어 있었다면 닫는다.
; 178  : 		closesocket(m_skSocket);

  00014	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00017	8b 08		 mov	 ecx, DWORD PTR [eax]
  00019	51		 push	 ecx
  0001a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__closesocket@4

; 179  : 		m_skSocket = INVALID_SOCKET;

  00020	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00023	c7 00 ff ff ff
	ff		 mov	 DWORD PTR [eax], -1
$LN2@EndMultiCa:

; 180  : 	}
; 181  : 
; 182  : 	if (m_hWorkerThread != INVALID_HANDLE_VALUE) {

  00029	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0002c	83 b8 a0 03 00
	00 ff		 cmp	 DWORD PTR [eax+928], -1
  00033	74 2f		 je	 SHORT $LN1@EndMultiCa

; 183  : 		TerminateThread(m_hWorkerThread, 0);

  00035	6a 00		 push	 0
  00037	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0003a	8b 88 a0 03 00
	00		 mov	 ecx, DWORD PTR [eax+928]
  00040	51		 push	 ecx
  00041	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__TerminateThread@8

; 184  : 		CloseHandle(m_hWorkerThread);

  00047	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0004a	8b 88 a0 03 00
	00		 mov	 ecx, DWORD PTR [eax+928]
  00050	51		 push	 ecx
  00051	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__CloseHandle@4

; 185  : 		m_hWorkerThread = INVALID_HANDLE_VALUE;

  00057	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0005a	c7 80 a0 03 00
	00 ff ff ff ff	 mov	 DWORD PTR [eax+928], -1
$LN1@EndMultiCa:

; 186  : 	}
; 187  : }

  00064	5f		 pop	 edi
  00065	5e		 pop	 esi
  00066	5b		 pop	 ebx
  00067	8b e5		 mov	 esp, ebp
  00069	5d		 pop	 ebp
  0006a	c3		 ret	 0
?EndMultiCast@CWzMultiCastSock@@QAEXXZ ENDP		; CWzMultiCastSock::EndMultiCast
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\WzMultiCastSock.cpp
;	COMDAT ?ReStartMultiCast@CWzMultiCastSock@@QAEHXZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
?ReStartMultiCast@CWzMultiCastSock@@QAEHXZ PROC		; CWzMultiCastSock::ReStartMultiCast, COMDAT
; _this$ = ecx

; 167  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 168  : 	EndMultiCast();

  0000c	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0000f	e8 00 00 00 00	 call	 ?EndMultiCast@CWzMultiCastSock@@QAEXXZ ; CWzMultiCastSock::EndMultiCast

; 169  : 
; 170  : 	return StartMultiCast(m_szIPADDR_JOIN);

  00014	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00017	83 c0 04	 add	 eax, 4
  0001a	50		 push	 eax
  0001b	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0001e	e8 00 00 00 00	 call	 ?StartMultiCast@CWzMultiCastSock@@QAEHPAD@Z ; CWzMultiCastSock::StartMultiCast

; 171  : }

  00023	5f		 pop	 edi
  00024	5e		 pop	 esi
  00025	5b		 pop	 ebx
  00026	8b e5		 mov	 esp, ebp
  00028	5d		 pop	 ebp
  00029	c3		 ret	 0
?ReStartMultiCast@CWzMultiCastSock@@QAEHXZ ENDP		; CWzMultiCastSock::ReStartMultiCast
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\WzMultiCastSock.cpp
;	COMDAT ?StartMultiCast@CWzMultiCastSock@@QAEHPAD@Z
_TEXT	SEGMENT
_addr$ = -64						; size = 4
_mreq$ = -60						; size = 8
_iERR$ = -52						; size = 4
_sockaddr$ = -48					; size = 16
_bRES$1 = -32						; size = 4
_szText$2 = -28						; size = 16
_iCOUNT$3 = -12						; size = 4
_this$ = -8						; size = 4
__$ArrayPad$ = -4					; size = 4
_lpszIPADDR$ = 8					; size = 4
?StartMultiCast@CWzMultiCastSock@@QAEHPAD@Z PROC	; CWzMultiCastSock::StartMultiCast, COMDAT
; _this$ = ecx

; 84   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 80 00 00
	00		 sub	 esp, 128		; 00000080H
  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000e	33 c5		 xor	 eax, ebp
  00010	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00013	53		 push	 ebx
  00014	56		 push	 esi
  00015	57		 push	 edi
  00016	89 4d f8	 mov	 DWORD PTR _this$[ebp], ecx

; 85   : 
; 86   : 	if (m_skSocket != INVALID_SOCKET) {

  00019	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0001c	83 38 ff	 cmp	 DWORD PTR [eax], -1
  0001f	74 15		 je	 SHORT $LN2@StartMulti

; 87   : 		// 이전에 소켓이 생성되어 있었다면 닫는다.
; 88   : 		closesocket(m_skSocket);

  00021	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00024	8b 08		 mov	 ecx, DWORD PTR [eax]
  00026	51		 push	 ecx
  00027	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__closesocket@4

; 89   : 		m_skSocket = INVALID_SOCKET;

  0002d	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00030	c7 00 ff ff ff
	ff		 mov	 DWORD PTR [eax], -1
$LN2@StartMulti:

; 90   : 	}
; 91   : 
; 92   : 	if (!lpszIPADDR) {

  00036	83 7d 08 00	 cmp	 DWORD PTR _lpszIPADDR$[ebp], 0
  0003a	75 68		 jne	 SHORT $LN3@StartMulti

; 93   : 		// 만약 지정된 IP가 없다면 IP를 받는다.
; 94   : 		INT iCOUNT = DoEnumIpAddress();

  0003c	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  0003f	e8 00 00 00 00	 call	 ?DoEnumIpAddress@CWzMultiCastSock@@QAEHXZ ; CWzMultiCastSock::DoEnumIpAddress
  00044	89 45 f4	 mov	 DWORD PTR _iCOUNT$3[ebp], eax

; 95   : 		if (iCOUNT > 0) {

  00047	83 7d f4 00	 cmp	 DWORD PTR _iCOUNT$3[ebp], 0
  0004b	7e 4e		 jle	 SHORT $LN5@StartMulti

; 96   : 			char szText [MAX_IPADDR_LEN];
; 97   : 			BOOL bRES = FALSE;

  0004d	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _bRES$1[ebp], 0

; 98   : 			bRES = GetEnummedIpAddress(0, szText);

  00054	8d 45 e4	 lea	 eax, DWORD PTR _szText$2[ebp]
  00057	50		 push	 eax
  00058	6a 00		 push	 0
  0005a	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  0005d	e8 00 00 00 00	 call	 ?GetEnummedIpAddress@CWzMultiCastSock@@QAEHHPAD@Z ; CWzMultiCastSock::GetEnummedIpAddress
  00062	89 45 e0	 mov	 DWORD PTR _bRES$1[ebp], eax

; 99   : 			if (bRES) {

  00065	83 7d e0 00	 cmp	 DWORD PTR _bRES$1[ebp], 0
  00069	74 27		 je	 SHORT $LN7@StartMulti

; 100  : 				memcpy (m_szIPADDR_JOIN, szText, MAX_IPADDR_LEN);

  0006b	6a 10		 push	 16			; 00000010H
  0006d	8d 45 e4	 lea	 eax, DWORD PTR _szText$2[ebp]
  00070	50		 push	 eax
  00071	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  00074	83 c1 04	 add	 ecx, 4
  00077	51		 push	 ecx
  00078	e8 00 00 00 00	 call	 _memcpy
  0007d	83 c4 0c	 add	 esp, 12			; 0000000cH

; 101  : 				m_szIPADDR_JOIN[MAX_IPADDR_LEN-1] = 0;

  00080	b8 01 00 00 00	 mov	 eax, 1
  00085	6b c8 0f	 imul	 ecx, eax, 15
  00088	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  0008b	c6 44 0a 04 00	 mov	 BYTE PTR [edx+ecx+4], 0

; 102  : 			}

  00090	eb 07		 jmp	 SHORT $LN8@StartMulti
$LN7@StartMulti:

; 103  : 			else {
; 104  : 				return FALSE;

  00092	33 c0		 xor	 eax, eax
  00094	e9 b0 01 00 00	 jmp	 $LN1@StartMulti
$LN8@StartMulti:

; 105  : 			}
; 106  : 		}

  00099	eb 07		 jmp	 SHORT $LN6@StartMulti
$LN5@StartMulti:

; 107  : 		else {
; 108  : 			return FALSE;

  0009b	33 c0		 xor	 eax, eax
  0009d	e9 a7 01 00 00	 jmp	 $LN1@StartMulti
$LN6@StartMulti:

; 109  : 		}
; 110  : 	}

  000a2	eb 25		 jmp	 SHORT $LN4@StartMulti
$LN3@StartMulti:

; 111  : 	else {
; 112  : 		memcpy (m_szIPADDR_JOIN, lpszIPADDR, MAX_IPADDR_LEN);

  000a4	6a 10		 push	 16			; 00000010H
  000a6	8b 45 08	 mov	 eax, DWORD PTR _lpszIPADDR$[ebp]
  000a9	50		 push	 eax
  000aa	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  000ad	83 c1 04	 add	 ecx, 4
  000b0	51		 push	 ecx
  000b1	e8 00 00 00 00	 call	 _memcpy
  000b6	83 c4 0c	 add	 esp, 12			; 0000000cH

; 113  : 		m_szIPADDR_JOIN[MAX_IPADDR_LEN-1] = 0;

  000b9	b8 01 00 00 00	 mov	 eax, 1
  000be	6b c8 0f	 imul	 ecx, eax, 15
  000c1	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  000c4	c6 44 0a 04 00	 mov	 BYTE PTR [edx+ecx+4], 0
$LN4@StartMulti:

; 114  : 	}
; 115  : 
; 116  : 	m_skSocket = socket (AF_INET, SOCK_DGRAM, IPPROTO_UDP);

  000c9	6a 11		 push	 17			; 00000011H
  000cb	6a 02		 push	 2
  000cd	6a 02		 push	 2
  000cf	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__socket@12
  000d5	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  000d8	89 01		 mov	 DWORD PTR [ecx], eax

; 117  : 	if (m_skSocket == INVALID_SOCKET) {

  000da	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  000dd	83 38 ff	 cmp	 DWORD PTR [eax], -1
  000e0	75 10		 jne	 SHORT $LN9@StartMulti

; 118  : 		m_skSocket = INVALID_SOCKET;

  000e2	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  000e5	c7 00 ff ff ff
	ff		 mov	 DWORD PTR [eax], -1

; 119  : 		return FALSE;

  000eb	33 c0		 xor	 eax, eax
  000ed	e9 57 01 00 00	 jmp	 $LN1@StartMulti
$LN9@StartMulti:

; 120  : 	}
; 121  : 
; 122  : 	SOCKADDR_IN sockaddr;
; 123  : 	sockaddr.sin_addr.s_addr = htonl (INADDR_ANY);

  000f2	6a 00		 push	 0
  000f4	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__htonl@4
  000fa	89 45 d4	 mov	 DWORD PTR _sockaddr$[ebp+4], eax

; 124  : 	sockaddr.sin_family = AF_INET;

  000fd	b8 02 00 00 00	 mov	 eax, 2
  00102	66 89 45 d0	 mov	 WORD PTR _sockaddr$[ebp], ax

; 125  : 	sockaddr.sin_port = htons (DEFAULT_MULTICAST_PORT);

  00106	68 89 93 00 00	 push	 37769			; 00009389H
  0010b	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__htons@4
  00111	66 89 45 d2	 mov	 WORD PTR _sockaddr$[ebp+2], ax

; 126  : 
; 127  : 	INT iERR;
; 128  : 
; 129  : 	iERR = bind (m_skSocket, (LPSOCKADDR) & sockaddr, sizeof (SOCKADDR_IN));

  00115	6a 10		 push	 16			; 00000010H
  00117	8d 45 d0	 lea	 eax, DWORD PTR _sockaddr$[ebp]
  0011a	50		 push	 eax
  0011b	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  0011e	8b 11		 mov	 edx, DWORD PTR [ecx]
  00120	52		 push	 edx
  00121	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__bind@12
  00127	89 45 cc	 mov	 DWORD PTR _iERR$[ebp], eax

; 130  : 	if (iERR == SOCKET_ERROR) {

  0012a	83 7d cc ff	 cmp	 DWORD PTR _iERR$[ebp], -1
  0012e	75 26		 jne	 SHORT $LN10@StartMulti

; 131  : 		// 멀티캐스팅 시 기본포트로 대기할 수 있도록 소켓에 전체주소(0) 를 바인딩한다.
; 132  : 		SaveLastError();

  00130	6a 00		 push	 0
  00132	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  00135	e8 00 00 00 00	 call	 ?SaveLastError@CWzMultiCastSock@@IAEXH@Z ; CWzMultiCastSock::SaveLastError

; 133  : 		closesocket(m_skSocket);

  0013a	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0013d	8b 08		 mov	 ecx, DWORD PTR [eax]
  0013f	51		 push	 ecx
  00140	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__closesocket@4

; 134  : 		m_skSocket = INVALID_SOCKET;

  00146	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00149	c7 00 ff ff ff
	ff		 mov	 DWORD PTR [eax], -1

; 135  : 		return FALSE;

  0014f	33 c0		 xor	 eax, eax
  00151	e9 f3 00 00 00	 jmp	 $LN1@StartMulti
$LN10@StartMulti:

; 136  : 	}
; 137  : 
; 138  : 	ip_mreq mreq;
; 139  : 	memset((char*)&mreq, 0, sizeof(ip_mreq));

  00156	6a 08		 push	 8
  00158	6a 00		 push	 0
  0015a	8d 45 c4	 lea	 eax, DWORD PTR _mreq$[ebp]
  0015d	50		 push	 eax
  0015e	e8 00 00 00 00	 call	 _memset
  00163	83 c4 0c	 add	 esp, 12			; 0000000cH

; 140  : 	mreq.imr_multiaddr.s_addr = inet_addr(DEFAULT_MULTICAST_IP);

  00166	68 00 00 00 00	 push	 OFFSET ??_C@_0BA@CLENKLPL@227?4100?4100?4100@
  0016b	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__inet_addr@4
  00171	89 45 c4	 mov	 DWORD PTR _mreq$[ebp], eax

; 141  : 	mreq.imr_interface.s_addr = inet_addr(m_szIPADDR_JOIN);

  00174	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00177	83 c0 04	 add	 eax, 4
  0017a	50		 push	 eax
  0017b	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__inet_addr@4
  00181	89 45 c8	 mov	 DWORD PTR _mreq$[ebp+4], eax

; 142  : 	
; 143  : 	iERR = setsockopt(m_skSocket, IPPROTO_IP, IP_ADD_MEMBERSHIP, (char *) & mreq, sizeof (mreq));

  00184	6a 08		 push	 8
  00186	8d 45 c4	 lea	 eax, DWORD PTR _mreq$[ebp]
  00189	50		 push	 eax
  0018a	6a 0c		 push	 12			; 0000000cH
  0018c	6a 00		 push	 0
  0018e	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  00191	8b 11		 mov	 edx, DWORD PTR [ecx]
  00193	52		 push	 edx
  00194	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__setsockopt@20
  0019a	89 45 cc	 mov	 DWORD PTR _iERR$[ebp], eax

; 144  : 	if (iERR == SOCKET_ERROR) {

  0019d	83 7d cc ff	 cmp	 DWORD PTR _iERR$[ebp], -1
  001a1	75 26		 jne	 SHORT $LN11@StartMulti

; 145  : 		SaveLastError();

  001a3	6a 00		 push	 0
  001a5	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  001a8	e8 00 00 00 00	 call	 ?SaveLastError@CWzMultiCastSock@@IAEXH@Z ; CWzMultiCastSock::SaveLastError

; 146  : 		closesocket(m_skSocket);

  001ad	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  001b0	8b 08		 mov	 ecx, DWORD PTR [eax]
  001b2	51		 push	 ecx
  001b3	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__closesocket@4

; 147  : 		m_skSocket = INVALID_SOCKET;

  001b9	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  001bc	c7 00 ff ff ff
	ff		 mov	 DWORD PTR [eax], -1

; 148  : 		return FALSE;

  001c2	33 c0		 xor	 eax, eax
  001c4	e9 80 00 00 00	 jmp	 $LN1@StartMulti
$LN11@StartMulti:

; 149  : 	}
; 150  : 
; 151  : 	unsigned long addr = inet_addr(m_szIPADDR_JOIN);

  001c9	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  001cc	83 c0 04	 add	 eax, 4
  001cf	50		 push	 eax
  001d0	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__inet_addr@4
  001d6	89 45 c0	 mov	 DWORD PTR _addr$[ebp], eax

; 152  : 	iERR = setsockopt(m_skSocket, IPPROTO_IP, IP_MULTICAST_IF, (char *)&addr, sizeof(addr));

  001d9	6a 04		 push	 4
  001db	8d 45 c0	 lea	 eax, DWORD PTR _addr$[ebp]
  001de	50		 push	 eax
  001df	6a 09		 push	 9
  001e1	6a 00		 push	 0
  001e3	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  001e6	8b 11		 mov	 edx, DWORD PTR [ecx]
  001e8	52		 push	 edx
  001e9	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__setsockopt@20
  001ef	89 45 cc	 mov	 DWORD PTR _iERR$[ebp], eax

; 153  : 	if (iERR == SOCKET_ERROR) {

  001f2	83 7d cc ff	 cmp	 DWORD PTR _iERR$[ebp], -1
  001f6	75 23		 jne	 SHORT $LN12@StartMulti

; 154  : 		SaveLastError();

  001f8	6a 00		 push	 0
  001fa	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  001fd	e8 00 00 00 00	 call	 ?SaveLastError@CWzMultiCastSock@@IAEXH@Z ; CWzMultiCastSock::SaveLastError

; 155  : 		closesocket(m_skSocket);

  00202	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00205	8b 08		 mov	 ecx, DWORD PTR [eax]
  00207	51		 push	 ecx
  00208	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__closesocket@4

; 156  : 		m_skSocket = INVALID_SOCKET;

  0020e	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00211	c7 00 ff ff ff
	ff		 mov	 DWORD PTR [eax], -1

; 157  : 		return FALSE;

  00217	33 c0		 xor	 eax, eax
  00219	eb 2e		 jmp	 SHORT $LN1@StartMulti
$LN12@StartMulti:

; 158  : 	}
; 159  : 
; 160  : 	// 부모윈도우가 지정되지 않았다면 읽기 스레드를 생성한다.
; 161  : 	m_hWorkerThread = (HANDLE) _beginthreadex (NULL, NULL, RecvThreadProc, (LPVOID) this, NULL, & m_idWorkerThread);

  0021b	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0021e	05 a4 03 00 00	 add	 eax, 932		; 000003a4H
  00223	50		 push	 eax
  00224	6a 00		 push	 0
  00226	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  00229	51		 push	 ecx
  0022a	68 00 00 00 00	 push	 OFFSET ?RecvThreadProc@CWzMultiCastSock@@SGIPAX@Z ; CWzMultiCastSock::RecvThreadProc
  0022f	6a 00		 push	 0
  00231	6a 00		 push	 0
  00233	e8 00 00 00 00	 call	 __beginthreadex
  00238	83 c4 18	 add	 esp, 24			; 00000018H
  0023b	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  0023e	89 82 a0 03 00
	00		 mov	 DWORD PTR [edx+928], eax

; 162  : 
; 163  : 	return TRUE;

  00244	b8 01 00 00 00	 mov	 eax, 1
$LN1@StartMulti:

; 164  : }

  00249	5f		 pop	 edi
  0024a	5e		 pop	 esi
  0024b	5b		 pop	 ebx
  0024c	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  0024f	33 cd		 xor	 ecx, ebp
  00251	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00256	8b e5		 mov	 esp, ebp
  00258	5d		 pop	 ebp
  00259	c2 04 00	 ret	 4
?StartMultiCast@CWzMultiCastSock@@QAEHPAD@Z ENDP	; CWzMultiCastSock::StartMultiCast
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\WzMultiCastSock.cpp
;	COMDAT ?GetEnummedIpAddress@CWzMultiCastSock@@QAEHHPAD@Z
_TEXT	SEGMENT
_this$ = -4						; size = 4
_iIPINDEX$ = 8						; size = 4
_lpszOutputIpAddress$ = 12				; size = 4
?GetEnummedIpAddress@CWzMultiCastSock@@QAEHHPAD@Z PROC	; CWzMultiCastSock::GetEnummedIpAddress, COMDAT
; _this$ = ecx

; 68   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 69   : 	if (iIPINDEX < 0 || iIPINDEX >= MAX_IPINFO)

  0000c	83 7d 08 00	 cmp	 DWORD PTR _iIPINDEX$[ebp], 0
  00010	7c 06		 jl	 SHORT $LN3@GetEnummed
  00012	83 7d 08 20	 cmp	 DWORD PTR _iIPINDEX$[ebp], 32 ; 00000020H
  00016	7c 04		 jl	 SHORT $LN2@GetEnummed
$LN3@GetEnummed:

; 70   : 		return FALSE;

  00018	33 c0		 xor	 eax, eax
  0001a	eb 37		 jmp	 SHORT $LN1@GetEnummed
$LN2@GetEnummed:

; 71   : 	
; 72   : 	if (m_stIPINFO_LIST[iIPINDEX].m_bInUsed ==TRUE) {

  0001c	6b 45 08 14	 imul	 eax, DWORD PTR _iIPINDEX$[ebp], 20
  00020	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00023	83 7c 01 14 01	 cmp	 DWORD PTR [ecx+eax+20], 1
  00028	75 27		 jne	 SHORT $LN4@GetEnummed

; 73   : 		if (lpszOutputIpAddress) {

  0002a	83 7d 0c 00	 cmp	 DWORD PTR _lpszOutputIpAddress$[ebp], 0
  0002e	74 21		 je	 SHORT $LN4@GetEnummed

; 74   : 			memcpy (lpszOutputIpAddress, m_stIPINFO_LIST[iIPINDEX].m_szIPADDR, MAX_IPADDR_LEN);

  00030	6a 10		 push	 16			; 00000010H
  00032	6b 45 08 14	 imul	 eax, DWORD PTR _iIPINDEX$[ebp], 20
  00036	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00039	8d 54 01 18	 lea	 edx, DWORD PTR [ecx+eax+24]
  0003d	52		 push	 edx
  0003e	8b 45 0c	 mov	 eax, DWORD PTR _lpszOutputIpAddress$[ebp]
  00041	50		 push	 eax
  00042	e8 00 00 00 00	 call	 _memcpy
  00047	83 c4 0c	 add	 esp, 12			; 0000000cH

; 75   : 			return TRUE;

  0004a	b8 01 00 00 00	 mov	 eax, 1
  0004f	eb 02		 jmp	 SHORT $LN1@GetEnummed
$LN4@GetEnummed:

; 76   : 		}
; 77   : 	}
; 78   : 	
; 79   : 	return FALSE;

  00051	33 c0		 xor	 eax, eax
$LN1@GetEnummed:

; 80   : }

  00053	5f		 pop	 edi
  00054	5e		 pop	 esi
  00055	5b		 pop	 ebx
  00056	8b e5		 mov	 esp, ebp
  00058	5d		 pop	 ebp
  00059	c2 08 00	 ret	 8
?GetEnummedIpAddress@CWzMultiCastSock@@QAEHHPAD@Z ENDP	; CWzMultiCastSock::GetEnummedIpAddress
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\WzMultiCastSock.cpp
;	COMDAT ?DoEnumIpAddress@CWzMultiCastSock@@QAEHXZ
_TEXT	SEGMENT
tv136 = -212						; size = 4
tv82 = -212						; size = 4
tv75 = -212						; size = 4
_lpaddr$ = -144						; size = 4
_lpHostent$ = -140					; size = 4
_buf$ = -136						; size = 128
_this$ = -8						; size = 4
__$ArrayPad$ = -4					; size = 4
?DoEnumIpAddress@CWzMultiCastSock@@QAEHXZ PROC		; CWzMultiCastSock::DoEnumIpAddress, COMDAT
; _this$ = ecx

; 39   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec d4 00 00
	00		 sub	 esp, 212		; 000000d4H
  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000e	33 c5		 xor	 eax, ebp
  00010	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00013	53		 push	 ebx
  00014	56		 push	 esi
  00015	57		 push	 edi
  00016	89 4d f8	 mov	 DWORD PTR _this$[ebp], ecx

; 40   : 	m_iIPINFO_COUNT = 0;

  00019	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0001c	c7 80 94 02 00
	00 00 00 00 00	 mov	 DWORD PTR [eax+660], 0

; 41   : 	memset(m_stIPINFO_LIST, 0, sizeof(m_stIPINFO_LIST));

  00026	68 80 02 00 00	 push	 640			; 00000280H
  0002b	6a 00		 push	 0
  0002d	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00030	83 c0 14	 add	 eax, 20			; 00000014H
  00033	50		 push	 eax
  00034	e8 00 00 00 00	 call	 _memset
  00039	83 c4 0c	 add	 esp, 12			; 0000000cH

; 42   : 
; 43   : 	char buf [128];
; 44   : 	gethostname (buf, sizeof (buf));

  0003c	68 80 00 00 00	 push	 128			; 00000080H
  00041	8d 85 78 ff ff
	ff		 lea	 eax, DWORD PTR _buf$[ebp]
  00047	50		 push	 eax
  00048	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__gethostname@8

; 45   : 
; 46   : 	LPHOSTENT lpHostent = gethostbyname (buf);

  0004e	8d 85 78 ff ff
	ff		 lea	 eax, DWORD PTR _buf$[ebp]
  00054	50		 push	 eax
  00055	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__gethostbyname@4
  0005b	89 85 74 ff ff
	ff		 mov	 DWORD PTR _lpHostent$[ebp], eax

; 47   : 
; 48   : 	in_addr * lpaddr;
; 49   : 
; 50   : 	switch (lpHostent->h_addrtype) {

  00061	8b 85 74 ff ff
	ff		 mov	 eax, DWORD PTR _lpHostent$[ebp]
  00067	0f bf 48 08	 movsx	 ecx, WORD PTR [eax+8]
  0006b	89 8d 2c ff ff
	ff		 mov	 DWORD PTR tv75[ebp], ecx
  00071	83 bd 2c ff ff
	ff 02		 cmp	 DWORD PTR tv75[ebp], 2
  00078	74 05		 je	 SHORT $LN4@DoEnumIpAd
  0007a	e9 ae 00 00 00	 jmp	 $LN2@DoEnumIpAd
$LN4@DoEnumIpAd:

; 51   : 
; 52   : 	case AF_INET :
; 53   : 
; 54   : 		while ( (lpaddr = ((in_addr *) * lpHostent->h_addr_list ++ )) != NULL) {

  0007f	8b 85 74 ff ff
	ff		 mov	 eax, DWORD PTR _lpHostent$[ebp]
  00085	8b 48 0c	 mov	 ecx, DWORD PTR [eax+12]
  00088	8b 11		 mov	 edx, DWORD PTR [ecx]
  0008a	89 95 70 ff ff
	ff		 mov	 DWORD PTR _lpaddr$[ebp], edx
  00090	8b 85 70 ff ff
	ff		 mov	 eax, DWORD PTR _lpaddr$[ebp]
  00096	89 85 2c ff ff
	ff		 mov	 DWORD PTR tv82[ebp], eax
  0009c	8b 8d 74 ff ff
	ff		 mov	 ecx, DWORD PTR _lpHostent$[ebp]
  000a2	8b 51 0c	 mov	 edx, DWORD PTR [ecx+12]
  000a5	83 c2 04	 add	 edx, 4
  000a8	8b 85 74 ff ff
	ff		 mov	 eax, DWORD PTR _lpHostent$[ebp]
  000ae	89 50 0c	 mov	 DWORD PTR [eax+12], edx
  000b1	83 bd 2c ff ff
	ff 00		 cmp	 DWORD PTR tv82[ebp], 0
  000b8	74 73		 je	 SHORT $LN2@DoEnumIpAd

; 55   : 			m_stIPINFO_LIST[m_iIPINFO_COUNT].m_bInUsed = TRUE;

  000ba	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  000bd	6b 88 94 02 00
	00 14		 imul	 ecx, DWORD PTR [eax+660], 20
  000c4	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  000c7	c7 44 0a 14 01
	00 00 00	 mov	 DWORD PTR [edx+ecx+20], 1

; 56   : 			strcpy (m_stIPINFO_LIST[m_iIPINFO_COUNT++].m_szIPADDR, inet_ntoa (*lpaddr));

  000cf	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  000d2	6b 88 94 02 00
	00 14		 imul	 ecx, DWORD PTR [eax+660], 20
  000d9	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  000dc	8d 44 0a 18	 lea	 eax, DWORD PTR [edx+ecx+24]
  000e0	89 85 2c ff ff
	ff		 mov	 DWORD PTR tv136[ebp], eax
  000e6	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  000e9	8b 91 94 02 00
	00		 mov	 edx, DWORD PTR [ecx+660]
  000ef	83 c2 01	 add	 edx, 1
  000f2	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  000f5	89 90 94 02 00
	00		 mov	 DWORD PTR [eax+660], edx
  000fb	8b 8d 70 ff ff
	ff		 mov	 ecx, DWORD PTR _lpaddr$[ebp]
  00101	8b 11		 mov	 edx, DWORD PTR [ecx]
  00103	52		 push	 edx
  00104	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__inet_ntoa@4
  0010a	50		 push	 eax
  0010b	8b 85 2c ff ff
	ff		 mov	 eax, DWORD PTR tv136[ebp]
  00111	50		 push	 eax
  00112	e8 00 00 00 00	 call	 _strcpy
  00117	83 c4 08	 add	 esp, 8

; 57   : 			if (m_iIPINFO_COUNT>=MAX_IPINFO)	break;

  0011a	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0011d	83 b8 94 02 00
	00 20		 cmp	 DWORD PTR [eax+660], 32	; 00000020H
  00124	7c 02		 jl	 SHORT $LN7@DoEnumIpAd
  00126	eb 05		 jmp	 SHORT $LN2@DoEnumIpAd
$LN7@DoEnumIpAd:

; 58   : 		}

  00128	e9 52 ff ff ff	 jmp	 $LN4@DoEnumIpAd
$LN2@DoEnumIpAd:

; 59   : 
; 60   : 		break;
; 61   : 	}
; 62   : 	
; 63   : 	return m_iIPINFO_COUNT;

  0012d	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00130	8b 80 94 02 00
	00		 mov	 eax, DWORD PTR [eax+660]

; 64   : }

  00136	5f		 pop	 edi
  00137	5e		 pop	 esi
  00138	5b		 pop	 ebx
  00139	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  0013c	33 cd		 xor	 ecx, ebp
  0013e	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00143	8b e5		 mov	 esp, ebp
  00145	5d		 pop	 ebp
  00146	c3		 ret	 0
?DoEnumIpAddress@CWzMultiCastSock@@QAEHXZ ENDP		; CWzMultiCastSock::DoEnumIpAddress
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\WzMultiCastSock.cpp
;	COMDAT ??1CWzMultiCastSock@@QAE@XZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
??1CWzMultiCastSock@@QAE@XZ PROC			; CWzMultiCastSock::~CWzMultiCastSock, COMDAT
; _this$ = ecx

; 31   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 32   :   shutdown (m_skSocket, 0x00);

  0000c	6a 00		 push	 0
  0000e	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00011	8b 08		 mov	 ecx, DWORD PTR [eax]
  00013	51		 push	 ecx
  00014	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__shutdown@8

; 33   :   closesocket (m_skSocket);

  0001a	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0001d	8b 08		 mov	 ecx, DWORD PTR [eax]
  0001f	51		 push	 ecx
  00020	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__closesocket@4

; 34   :   WSACleanup ();

  00026	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSACleanup@0

; 35   : }

  0002c	5f		 pop	 edi
  0002d	5e		 pop	 esi
  0002e	5b		 pop	 ebx
  0002f	8b e5		 mov	 esp, ebp
  00031	5d		 pop	 ebp
  00032	c3		 ret	 0
??1CWzMultiCastSock@@QAE@XZ ENDP			; CWzMultiCastSock::~CWzMultiCastSock
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\WzMultiCastSock.cpp
;	COMDAT ??0CWzMultiCastSock@@QAE@XZ
_TEXT	SEGMENT
_wsadata$ = -408					; size = 400
_this$ = -8						; size = 4
__$ArrayPad$ = -4					; size = 4
??0CWzMultiCastSock@@QAE@XZ PROC			; CWzMultiCastSock::CWzMultiCastSock, COMDAT
; _this$ = ecx

; 18   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec d8 01 00
	00		 sub	 esp, 472		; 000001d8H
  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000e	33 c5		 xor	 eax, ebp
  00010	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00013	53		 push	 ebx
  00014	56		 push	 esi
  00015	57		 push	 edi
  00016	89 4d f8	 mov	 DWORD PTR _this$[ebp], ecx

; 19   : 	WSADATA wsadata;
; 20   : 	WSAStartup(MAKEWORD(1,1), &wsadata);

  00019	8d 85 68 fe ff
	ff		 lea	 eax, DWORD PTR _wsadata$[ebp]
  0001f	50		 push	 eax
  00020	68 01 01 00 00	 push	 257			; 00000101H
  00025	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSAStartup@8

; 21   : 
; 22   : 	m_skSocket					= INVALID_SOCKET;

  0002b	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0002e	c7 00 ff ff ff
	ff		 mov	 DWORD PTR [eax], -1

; 23   : 	m_iIPINFO_COUNT				= 0;

  00034	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00037	c7 80 94 02 00
	00 00 00 00 00	 mov	 DWORD PTR [eax+660], 0

; 24   : 	m_lpfnCALLBACK_RECVNOTIFY	= NULL;

  00041	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00044	c7 80 a8 03 00
	00 00 00 00 00	 mov	 DWORD PTR [eax+936], 0

; 25   : 	m_lpfnCALLBACK_ERRORNOTIFY	= NULL;

  0004e	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00051	c7 80 ac 03 00
	00 00 00 00 00	 mov	 DWORD PTR [eax+940], 0

; 26   : 	memset(m_stIPINFO_LIST, 0, sizeof(m_stIPINFO_LIST));

  0005b	68 80 02 00 00	 push	 640			; 00000280H
  00060	6a 00		 push	 0
  00062	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00065	83 c0 14	 add	 eax, 20			; 00000014H
  00068	50		 push	 eax
  00069	e8 00 00 00 00	 call	 _memset
  0006e	83 c4 0c	 add	 esp, 12			; 0000000cH

; 27   : }

  00071	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00074	5f		 pop	 edi
  00075	5e		 pop	 esi
  00076	5b		 pop	 ebx
  00077	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  0007a	33 cd		 xor	 ecx, ebp
  0007c	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00081	8b e5		 mov	 esp, ebp
  00083	5d		 pop	 ebp
  00084	c3		 ret	 0
??0CWzMultiCastSock@@QAE@XZ ENDP			; CWzMultiCastSock::CWzMultiCastSock
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\WzMultiCastSock.cpp
;	COMDAT ?__empty_global_delete@@YAXPAXI@Z
_TEXT	SEGMENT
___formal$ = 8						; size = 4
___formal$ = 12						; size = 4
?__empty_global_delete@@YAXPAXI@Z PROC			; __empty_global_delete, COMDAT

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	5f		 pop	 edi
  0000a	5e		 pop	 esi
  0000b	5b		 pop	 ebx
  0000c	8b e5		 mov	 esp, ebp
  0000e	5d		 pop	 ebp
  0000f	c3		 ret	 0
?__empty_global_delete@@YAXPAXI@Z ENDP			; __empty_global_delete
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File C:\Mu Online\Mu-GS-Webzen-MC-10093\GameServer\WzMultiCastSock.cpp
;	COMDAT ?__empty_global_delete@@YAXPAX@Z
_TEXT	SEGMENT
___formal$ = 8						; size = 4
?__empty_global_delete@@YAXPAX@Z PROC			; __empty_global_delete, COMDAT

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	5f		 pop	 edi
  0000a	5e		 pop	 esi
  0000b	5b		 pop	 ebx
  0000c	8b e5		 mov	 esp, ebp
  0000e	5d		 pop	 ebp
  0000f	c3		 ret	 0
?__empty_global_delete@@YAXPAX@Z ENDP			; __empty_global_delete
_TEXT	ENDS
END
